<!DOCTYPE html>
<html>
<head>
  <%- include('../partials/setup.ejs') %>
  <link rel="stylesheet" href="/views/pages/homepage.css">
  <script src="../../resources/js/voting.js"></script>
  <title>Buff Forums Home</title>
</head>
<body>
  <!--Navigation-->
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <ul class="navbar-nav">
      <li class="nav-item active">
          <h2>Buff Forums</h2>
      </li>
      <li>
          <a class="nav-link" href="/home">Home</a>
      </li>
      
      <li class="nav-item">
          <a class="nav-link" href="/postview">Post View</a>
      </li>

      <li class="nav-item">
          <a class="nav-link " href="/createPost">Create Post</a>
      </li>


    </ul>
  </nav>
  <!--Subforum sidebar-->
  <div class="sidenav">
    <h2> Sidebar </h2>
    <%
    if(subForums) {
      let subForumUrl='';
      let subForumName='';
      subForums.forEach(function(forumInfo) {
        subForumName=forumInfo.subforum_name;
        subForumUrl=forumInfo.subforum_url;
    %>
        <a href=<%=subForumUrl%>> <%=subForumName%> </a>
    <%
      });
    }
    %>

  </div>
    
    <div class="main">
      <div class="postList">
          <div id="wrapper">
            <table id="postContent" style="table-layout: fixed;">
              <%  var i = 0;
                  var postRow = '';
                  posts.every(function(item){
                    <!--HTML for up/down voting-->
                    var voting = '<td id="votingOp"><div>'+
                      '<input type="image" src="../../resources/images/upvote.png" id="vote" onclick="vote(1)" />'+
                      '<span id="voteNum" >'+item.vote_amount+'</span>'+
                      '<input type="image" src=".../../resources/images/downvote.png" id="vote" onclick="vote(-1)" />'+
                      '</div></td>';
                    postRow = '<tr>'+ voting; <!--Adds voting to row-->

                    

                    <!-- Gets info from get request and stores in span tags -->
                      <!-- var preview = `<img src='' style='max-width:100%; max-height:100%'>`;-->
                    var title = '<span class="title">'+item.post_title+'</span><br>';
                    var author = '<span class="author">Posted by '+item.post_creator_name+'</span>';

                    <!-- Links the row to its appropriate post link -->
                    postRow += `<td class="postInfo"><a href="/postview/postID=${item.post_id}?">${title+author}</td>`; <!--Adds post info to row-->
                    
                    postRow += '</a></tr>'; <!--Ends row-->
              %>
                
                <%- postRow %>
                <%  i++;
                    <!-- Only shows 50 posts on homepage -->
                    if(i < 50){return true} 
                    });
                %>
            </table>
        </div>
      </div>
    </div>

  </body>

</html> 
